!function(t){t.TumblrPosts=function(a,s){var o={tumblrId:null,postId:null,start:0,num:50,tagged:null,ptype:null},n=this;n.settings={},n.tumblr={};var e=t(a);n.init=function(){n.settings=t.extend({},o,s),n.settings.tumblrId&&n.load()},n.load=function(a){n.settings=t.extend(n.settings,a),t.ajax({type:"GET",cache:!0,url:"http://"+n.settings.tumblrId+".tumblr.com/api/read/json/?"+(n.settings.postId?"id="+n.settings.postId:"start="+n.settings.start+"&num="+n.settings.num+(n.settings.tagged?"&tagged="+n.settings.tagged:"")+(n.settings.ptype?"&type="+n.settings.ptype:"")),dataType:"jsonp",jsonpCallback:"jqTumblrHandlr",success:i}),l()};var i=function(t){n.tumblr=t,console.log(t),e.append("<h1>"+t.tumblelog.title+"</h1>"),window.document.title=t.tumblelog.title+" - Tumblr";for(var a in t.posts)"photo"==t.posts[a].type?p(t.posts[a]):"regular"==t.posts[a].type?v(t.posts[a]):"video"==t.posts[a].type?u(t.posts[a]):"audio"==t.posts[a].type?d(t.posts[a]):console.log(t.posts[a])},l=function(){e.empty()},r=function(t){var a=/<(?!\/?(a|p|br|blockquote)(?=>|\s.*>))\/?.*?>/gi,s=t.replace(a,"");return s},p=function(a){var s=t('<div class="post"></div>'),o=a.photos&&a.photos.length>0?a.photos:[a],n=['<div class="images">'];for(var i in o)n.push('<a class="nolink hoverZoomLink" href="'+o[i]["photo-url-1280"]+'" target="_blank">','<img src="'+o[i]["photo-url-1280"]+'">',"</a>");n.push("</div>"),s.append(n.join("")),a["photo-caption"]&&s.append('<div class="caption">'+r(a["photo-caption"])+"</div>"),c(s,a),e.append(s)},u=function(a){if(a["video-player-500"]){var s=t('<div class="post"></div>'),o=a["video-player-500"].match(/<video/gi)?"html5-video":"video";s.append('<div class="'+o+'">'+a["video-player-500"]+"</div>"),a["video-caption"]&&s.append('<div class="caption">'+r(a["video-caption"])+"</div>"),c(s,a),e.append(s)}},d=function(a){var s=t('<div class="post"></div>');s.append('<div class="audio">'+a["audio-player"]+"</div>"),a["audio-caption"]&&s.append('<div class="caption">'+r(a["audio-caption"])+"</div>"),c(s,a),e.append(s)},v=function(a){var s=t('<div class="post"></div>');a["regular-title"]&&s.append("<h2>"+a["regular-title"]+"</h2>"),a["regular-body"]&&s.append('<div class="images"><a class="nolink" href="'+a["url-with-slug"]+'" target="_blank">'+a["regular-body"]+"</a></div>"),c(s,a),e.append(s)},c=function(t,a){t.append('<div class="source">Source: <a href="'+a["url-with-slug"]+'" target="_blank">'+a["url-with-slug"]+"</a>"+(a.hasOwnProperty("photo-link-url")?' (<a href="'+a["photo-link-url"]+'">'+a["photo-link-url"]+"</a>)":"")+"</div>")};n.init()},t.fn.TumblrPosts=function(a){return this.each(function(){if(void 0===t(this).data("TumblrPosts")){var s=new t.TumblrPosts(this,a);t(this).data("TumblrPosts",s)}})}}(jQuery),$(function(){window.tumblrPosts=$("#images").TumblrPosts().data("TumblrPosts");var t;$("#form").submit(function(a){a.preventDefault(),$("#tumblrId").val()!==t&&$("#start").val(0);var s={tumblrId:$("#tumblrId").val(),postId:$("#postId").val(),tagged:$("#tagged").val(),ptype:$('input[name="ptype"]:checked').val(),start:$("#start").val(),num:$("#num").val()};t=s.tumblrId,$.bbq.pushState(s),$("#showform, #navigation").show(),$("#inputform").hide()}),$("#first").click(function(t){t.preventDefault();var a=0;$("#start").val(a),$("#form").submit(),window.scrollTo(0,0)}),$("#prev").click(function(t){t.preventDefault();var a=parseInt($("#start").val()),s=parseInt($("#num").val()),o=a-s;o=o>=0?o:0,$("#start").val(o),$("#form").submit(),window.scrollTo(0,0)}),$("#next").click(function(t){t.preventDefault();var a=parseInt($("#start").val()),s=parseInt($("#num").val()),o=tumblrPosts.tumblr["posts-total"]-s,n=a+s;n=o>=n?n:o,n=n>0?n:0,$("#start").val(n),$("#form").submit(),window.scrollTo(0,0)}),$("#last").click(function(t){t.preventDefault();var a=parseInt($("#num").val()),s=tumblrPosts.tumblr["posts-total"]-a;s=s>0?s:0,$("#start").val(s),$("#form").submit(),window.scrollTo(0,0)}),$("#toggleadvopts").click(function(t){t.preventDefault(),$("#advoptions").toggle()}),$("#showform a").click(function(t){t.preventDefault(),$("#showform, #inputform").toggle()}),$(window).bind("hashchange",function(a){if(""!==a.fragment){var s=a.getState();$("#tumblrId").val(s.tumblrId),$("#postId").val(s.postId),$("#tagged").val(s.tagged),$('input[name="ptype"][value="'+s.ptype+'"]').prop("checked",!0),$("#start").val(s.start),$("#num").val(s.num),t=s.tumblrId,tumblrPosts.load(s),$("#showform, #navigation").show(),$("#inputform").hide()}}),$(window).trigger("hashchange")});